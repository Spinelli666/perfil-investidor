{% extends 'questionario/base.html' %}
{% load static %}

{% block title %}Questionário - Perfil do Investidor{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/questionario.css' %}">
{% endblock %}

{% block content %}
<div class="container questionario-container">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="card questionario-card">
                <div class="card-header questionario-header text-white text-center">
                    <h2 class="mb-0">
                        <i class="bi bi-clipboard-check me-2"></i>
                        Questionário de Perfil do Investidor
                    </h2>
                </div>
                
                <div class="card-body p-4">
                    <div class="alert alert-info mb-4" role="alert">
                        <i class="bi bi-info-circle me-2"></i>
                        <strong>Instruções:</strong> Responda todas as perguntas com sinceridade. 
                        Não existem respostas certas ou erradas, apenas diferentes perfis de investimento.
                    </div>
                    
                    <form method="post" id="questionarioForm">
                        {% csrf_token %}
                        
                        <!-- Progress Bar -->
                        <div class="progress-section">
                            <div class="d-flex justify-content-between mb-2">
                                <span class="text-muted">Progresso</span>
                                <span class="text-muted">
                                    <span id="progress-text">0</span> de <span id="total-questions">10</span> perguntas
                                </span>
                            </div>
                            <div class="progress">
                                <div class="progress-bar bg-primary" role="progressbar" 
                                     style="width: 0%" id="progress-bar"></div>
                            </div>
                        </div>
                        
                        <!-- Aqui serão inseridas as perguntas do questionário -->
                        <div id="questions-container" class="question-container">
                            <!-- Exemplo de estrutura para as perguntas que serão adicionadas -->
                            <div class="alert alert-warning text-center">
                                <i class="bi bi-construction me-2"></i>
                                <strong>Perguntas do Questionário</strong><br>
                                <small>As perguntas específicas serão adicionadas aqui conforme suas necessidades.</small>
                                
                                <!-- Template de exemplo para uma pergunta -->
                                <div class="question-example">
                                    <h6 class="fw-bold">Exemplo de Pergunta:</h6>
                                    <p class="mb-3">Qual é a sua experiência com investimentos?</p>
                                    
                                    <div class="form-check mb-2">
                                        <input class="form-check-input" type="radio" name="pergunta_exemplo" value="1" id="exemplo1">
                                        <label class="form-check-label" for="exemplo1">
                                            Iniciante - Pouca ou nenhuma experiência
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input class="form-check-input" type="radio" name="pergunta_exemplo" value="2" id="exemplo2">
                                        <label class="form-check-label" for="exemplo2">
                                            Intermediário - Alguma experiência
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input class="form-check-input" type="radio" name="pergunta_exemplo" value="3" id="exemplo3">
                                        <label class="form-check-label" for="exemplo3">
                                            Avançado - Experiência significativa
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Botões de Navegação -->
                        <div class="question-navigation d-flex justify-content-between">
                            <a href="{% url 'questionario:home' %}" class="btn btn-outline-secondary">
                                <i class="bi bi-arrow-left me-2"></i>
                                Voltar ao Início
                            </a>
                            
                            <button type="submit" class="btn btn-primary btn-submit-disabled" id="submit-btn" disabled>
                                <i class="bi bi-check-circle me-2"></i>
                                Finalizar Questionário
                            </button>
                        </div>
                    </form>
                </div>
            </div>
            
            <!-- Informações Adicionais -->
            <div class="row info-cards">
                <div class="col-md-6">
                    <div class="card h-100">
                        <div class="card-body text-center">
                            <i class="bi bi-shield-lock text-success mb-3" style="font-size: 2rem;"></i>
                            <h6>Dados Seguros</h6>
                            <small class="text-muted">Suas respostas são confidenciais e utilizadas apenas para determinar seu perfil</small>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card h-100">
                        <div class="card-body text-center">
                            <i class="bi bi-clock-history text-info mb-3" style="font-size: 2rem;"></i>
                            <h6>Tempo Estimado</h6>
                            <small class="text-muted">O questionário leva entre 5 a 10 minutos para ser concluído</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // Função para atualizar a barra de progresso
    function updateProgress() {
        const totalQuestions = 10; // Atualizar conforme o número real de perguntas
        const answeredQuestions = document.querySelectorAll('input[type="radio"]:checked').length;
        const progressPercent = (answeredQuestions / totalQuestions) * 100;
        
        document.getElementById('progress-bar').style.width = progressPercent + '%';
        document.getElementById('progress-text').textContent = answeredQuestions;
        document.getElementById('total-questions').textContent = totalQuestions;
        
        // Habilitar botão submit quando todas as perguntas forem respondidas
        const submitBtn = document.getElementById('submit-btn');
        if (answeredQuestions === totalQuestions) {
            submitBtn.disabled = false;
            submitBtn.classList.remove('btn-outline-primary');
            submitBtn.classList.add('btn-primary');
        } else {
            submitBtn.disabled = true;
            submitBtn.classList.remove('btn-primary');
            submitBtn.classList.add('btn-outline-primary');
        }
    }
    
    // Adicionar event listeners aos inputs de radio quando as perguntas forem adicionadas
    document.addEventListener('DOMContentLoaded', function() {
        const radioInputs = document.querySelectorAll('input[type="radio"]');
        radioInputs.forEach(input => {
            input.addEventListener('change', updateProgress);
        });
        
        // Inicializar progresso
        updateProgress();
    });
</script>
{% endblock %}
